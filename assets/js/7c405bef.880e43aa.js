"use strict";(self.webpackChunkterranetes=self.webpackChunkterranetes||[]).push([["6325"],{4544:function(e,n,r){r.r(n),r.d(n,{metadata:()=>t,contentTitle:()=>a,default:()=>h,assets:()=>c,toc:()=>l,frontMatter:()=>o});var t=JSON.parse('{"id":"developer/tnctl","title":"Terranetes CLI","description":"The Terranetes platform includes a comprehensive command-line interface tool, tnctl, which facilitates cloud resources lifecycle management. The search subcommand is specifically designed to traverse and index resources from prominent sources, including:","source":"@site/docs/terranetes-controller/developer/tnctl.md","sourceDirName":"developer","slug":"/developer/tnctl","permalink":"/terranetes-controller/developer/tnctl","draft":false,"unlisted":false,"editUrl":"https://github.com/appvia/terranetes/tree/master/docs/terranetes-controller/developer/tnctl.md","tags":[],"version":"current","lastUpdatedBy":"dependabot[bot]","lastUpdatedAt":1745161406000,"sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Provisioning a Resource","permalink":"/terranetes-controller/developer/provision"},"next":{"title":"Using Private Repositories","permalink":"/terranetes-controller/developer/private"}}'),s=r("5893"),i=r("65");let o={sidebar_position:1},a="Terranetes CLI",c={},l=[{value:"How to search",id:"how-to-search",level:2},{value:"Adding Sources",id:"adding-sources",level:2},{value:"Adding your Github organization",id:"adding-your-github-organization",level:3},{value:"Adding the Terraform Registry",id:"adding-the-terraform-registry",level:3},{value:"Integrate with Kubectl",id:"integrate-with-kubectl",level:2},{value:"Watching Logs",id:"watching-logs",level:2},{value:"Describing Configurations",id:"describing-configurations",level:2}];function d(e){let n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"terranetes-cli",children:"Terranetes CLI"})}),"\n",(0,s.jsxs)(n.p,{children:["The Terranetes platform includes a comprehensive command-line interface tool, ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl",children:"tnctl"}),", which facilitates cloud resources lifecycle management. The ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl_search",children:"search"})," subcommand is specifically designed to traverse and index resources from prominent sources, including:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.a,{href:"https://registry.terraform.io",children:"Terraform registry"}),", a central hub for Terraform modules."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com",children:"Github"})," repositories and releases, encompassing a wide range of organizations and users."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For access to the tnctl tool, please refer to the ",(0,s.jsx)(n.a,{href:"/terranetes-controller/releases",children:"Releases"})," section for download instructions."]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-search",children:"How to search"}),"\n",(0,s.jsx)(n.p,{children:"Upon configuring one or more sources, you can initiate a search for cloud resources using the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"tnctl search [TERMS]\n"})}),"\n",(0,s.jsxs)(n.p,{children:["For instance, to search for a ",(0,s.jsx)(n.code,{children:"database"})," module specifically on ",(0,s.jsx)(n.code,{children:"aws"}),", you would execute:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"$ tnctl search database\n? What cloud provider should we scope the search to? aws\n? Which resource do you want to provision?\n  \u25B8[TF] terraform-aws-modules/dms\n   [TF] babbel/secretsmanager-for-database-url\n   [TF] terraform-aws-modules/dms\n   [TF] connect-group/rds-finalsnapshot\n   [TF] azavea/postgresql-rds\n   [TF] franviera92/aurora\n   [TF] bridgecrewio/secured-postgresql-rds\n   [TF] felipefrizzo/rds-mysql\n   [TF] felipefrizzo/rds-postgres\n   [TF] devops4me/postgres-rds\n   [TF] jessiehernandez/autorotated-database-credentials\n   [TF] mnanchev/database-migration-service\n   [TF] aleks-fofanov/rds-lambda-db-provisioner\n   [TF] jessiehernandez/database-credentials-rotator\n\u2193  [TF] offensive-terraform/rds-snapshot-publicly-exposed\n\nName:       dms\nNamespace:  terraform-aws-modules\nModule:     https://github.com/terraform-aws-modules/terraform-aws-dms\nSource:     https://registry.terraform.io/namespaces/terraform-aws-modules\nCreated:    2022-06-23 17:41:50.716218 +0000 UTC\nDownloads:  16436\n\nTerraform module which creates AWS DMS (Database Migration Service) resources\n"})}),"\n",(0,s.jsx)(n.p,{children:"Subsequently, you will be prompted to select the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tagged version"}),"\n",(0,s.jsxs)(n.li,{children:["Provide any ",(0,s.jsx)(n.strong,{children:"required"})," inputs ",(0,s.jsx)(n.em,{children:"(e.g., names, storage sizes, etc.)"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Ultimately, this process will generate a ",(0,s.jsx)(n.a,{href:"/terranetes-controller/reference/configurations.terraform.appvia.io",children:"Configuration"})," CRD, ready for integration into your deployment pipeline."]}),"\n",(0,s.jsx)(n.h2,{id:"adding-sources",children:"Adding Sources"}),"\n",(0,s.jsxs)(n.p,{children:["To integrate additional sources with the ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl",children:"tnctl"})," command, utilize the ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl_config_sources",children:"tnctl config sources"})," command. This allows for the incorporation of new sources, as exemplified by the following process."]}),"\n",(0,s.jsx)(n.h3,{id:"adding-your-github-organization",children:"Adding your Github organization"}),"\n",(0,s.jsx)(n.p,{children:"To incorporate your Github organization as a source for Terraform modules, execute the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"tnctl config sources add https://github.com/appvia\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"important",children:(0,s.jsxs)(n.p,{children:["If any of the Terraform modules are located within private repositories, it is essential to set your Github token as an environment variable using the command ",(0,s.jsx)(n.code,{children:"export GITHUB_TOKEN=TOKEN"}),". This step is crucial for ensuring access to private repositories."]})}),"\n",(0,s.jsx)(n.h3,{id:"adding-the-terraform-registry",children:"Adding the Terraform Registry"}),"\n",(0,s.jsx)(n.p,{children:"To integrate the Terraform registry, execute the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"tnctl config sources add https://registry.terraform.io\n"})}),"\n",(0,s.jsx)(n.p,{children:"Alternatively, you can specify a particular namespace within the Terraform registry by using the following command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"tnctl config sources add https://registry.terraform.io/namespaces/terraform-aws-modules\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["It is possible to add multiple sources as needed. The ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl_search",children:"search"})," functionality will consolidate the results and present them in a unified manner."]})}),"\n",(0,s.jsx)(n.h2,{id:"integrate-with-kubectl",children:"Integrate with Kubectl"}),"\n",(0,s.jsxs)(n.p,{children:["To integrate tnctl with Kubectl, execute the following steps to enable the use of ",(0,s.jsx)(n.code,{children:"kubectl tnctl COMMAND"}),"."]}),"\n",(0,s.jsx)(n.admonition,{type:"important",children:(0,s.jsxs)(n.p,{children:["Kubectl is capable of recognizing plugins based on their naming convention. For example, if you place an executable script named ",(0,s.jsx)(n.code,{children:"kubectl-hello-world"})," in your ",(0,s.jsx)(n.code,{children:"$PATH"}),", it can be invoked using the command ",(0,s.jsx)(n.code,{children:"$ kubectl hello world"}),". The ",(0,s.jsx)(n.code,{children:"tnctl kubectl plugin"})," generates a collection of such alias scripts, including ",(0,s.jsx)(n.code,{children:"kubectl-tnctl-describe"}),", ",(0,s.jsx)(n.code,{children:"kubectl-tnctl-logs"}),", and others, in a specified location."]})}),"\n",(0,s.jsx)(n.p,{children:"To complete the integration:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Execute the ",(0,s.jsx)(n.code,{children:"tnctl kubectl plugin -d DIRECTORY"})," command, specifying the directory where the alias scripts should be located."]}),"\n",(0,s.jsxs)(n.li,{children:["Ensure the generated alias scripts are included in your environment's ",(0,s.jsx)(n.code,{children:"$PATH"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Verify that ",(0,s.jsx)(n.code,{children:"tnctl"})," is also included in your environment's ",(0,s.jsx)(n.code,{children:"$PATH"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You can now utilize the integrated functionality with Kubectl. (see how to set tab completion ",(0,s.jsx)(n.a,{href:"https://kubernetes.io/docs/reference/kubectl/generated/kubectl_completion/",children:"here"}),")."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"By following these steps, you will be able to leverage the capabilities of tnctl directly within your Kubectl workflow."}),"\n",(0,s.jsx)(n.h2,{id:"watching-logs",children:"Watching Logs"}),"\n",(0,s.jsx)(n.p,{children:"When a Configuration is executed, a pod is created in the designated namespace to monitor the logs. To access these logs, follow these steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Retrieve the list of pods using the command ",(0,s.jsx)(n.code,{children:"kubectl get pods"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Identify the relevant pod based on the Configuration name and generation."}),"\n",(0,s.jsxs)(n.li,{children:["Monitor the logs by executing the command ",(0,s.jsx)(n.code,{children:"kubectl logs NAME -f"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For a more efficient approach, consider using the ",(0,s.jsx)(n.a,{href:"/terranetes-controller/cli/tnctl_logs",children:"tcnl logs"})," command."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Execute ",(0,s.jsx)(n.code,{children:"tnctl logs -n NAMESPACE NAME [-f--follow]"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["If the kubectl plugin integration is enabled, you can use ",(0,s.jsx)(n.code,{children:"kubectl tnctl logs [-n NAMESPACE] NAME [-f|--follow]"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ tnctl logs [cloudresource|configuration] -n apps bucket -f\n[info] waiting for the job to be scheduled\n[info] watching build: bucket, generation: 1 for the job to be scheduled\n........\n=======================================================\n\'SETTING UP THE ENVIRONMENT\'\n=======================================================\ntime="2022-08-09T09:59:37Z" level=info msg="downloading the assets" dest=/data source="https://github.com/terraform-aws-modules/terraform-aws-s3-bucket.git?ref=v3.1.0"\ntime="2022-08-09T09:59:38Z" level=info msg="successfully downloaded the source" source="https://github.com/terraform-aws-modules/terraform-aws-s3-bucket.git?ref=v3.1.0"\ntime="2022-08-09T09:59:38Z" level=info msg="successfully executed the step"\n\nInitializing the backend...\n\nSuccessfully configured the backend "kubernetes"! Terraform will automatically\nuse this backend unless the backend configuration changes.\n...\n'})}),"\n",(0,s.jsx)(n.h2,{id:"describing-configurations",children:"Describing Configurations"}),"\n",(0,s.jsx)(n.p,{children:"To gain detailed insights into costs and policy, you can utilize the following commands:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"tnctl describe [cloudresource|configuration] -n NAMESPACE [NAME]"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"kubectl tnctl describe [cloudresource|configuration] [-n NAMESPACE] [NAME]"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"These commands facilitate the retrieval of comprehensive information about costs and policy associated with cloud resources or configurations within a specified namespace."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"[jest@starfury terranetes-controller]$ bin/tnctl describe [cloudresource|configuration] -n apps bucket\nName:         bucket\nNamespace:    apps\nCreated:      2022-08-09T09:59:28Z\nStatus:       OutOfSync\nAnnotations:\n              terraform.appvia.io/apply    false\nLabels:       None\n\nConditions:\n==========\nName               Reason             Message\nProvider ready     Ready              Provider ready\nTerraform Plan     Ready              Terraform plan is complete\nSecurity Policy    ActionRequired     Configuration has failed security policy, refusing to continue\nTerraform Apply    ActionRequired     Waiting for terraform apply annotation to be set to true\nReady              NotDetermined\n\nConfiguration:\n=============\nAuthentication: None\nModule:         https://github.com/terraform-aws-modules/terraform-aws-s3-bucket.git?ref=v3.1.0\nProvider:       aws\nSecret:         apps/test\n\nCheckov Security Policy:\n=======================\nStatus:         Configuration has passed 11 and failed on 3 checks.\n\nCKV_AWS_18     FAILED\n\u251C\u2500 Name:       Ensure the S3 bucket has access logging enabled\n\u251C\u2500 Resource:   aws_s3_bucket.this[0]\n\u2514\u2500 Guide:      https://docs.bridgecrew.io/docs/s3_13-enable-logging\nCKV_AWS_144    FAILED\n\u251C\u2500 Name:       Ensure that S3 bucket has cross-region replication enabled\n\u251C\u2500 Resource:   aws_s3_bucket.this[0]\n\u2514\u2500 Guide:      https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled\n...\n"})})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},65:function(e,n,r){r.d(n,{Z:function(){return a},a:function(){return o}});var t=r(7294);let s={},i=t.createContext(s);function o(e){let n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);