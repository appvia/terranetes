"use strict";(self.webpackChunkterranetes=self.webpackChunkterranetes||[]).push([[3246],{8760:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>c});var a=r(4848),s=r(8453);const t={sidebar_position:7,sidebar_class_name:"green"},o="Kubernetes RBAC",i={id:"admin/rbac",title:"Kubernetes RBAC",description:"The following gives some guidance around the suggested roles and permissions in Kubernetes for consumers. In all cases, to remove duplication, the permissions are defined as a ClusterRole and bound locally within a namespace.",source:"@site/docs/terranetes-controller/admin/rbac.md",sourceDirName:"admin",slug:"/admin/rbac",permalink:"/terranetes-controller/admin/rbac",draft:!1,unlisted:!1,editUrl:"https://github.com/appvia/terranetes/tree/master/docs/terranetes-controller/admin/rbac.md",tags:[],version:"current",lastUpdatedBy:"Rohith Jayawardene",lastUpdatedAt:1730306116e3,sidebarPosition:7,frontMatter:{sidebar_position:7,sidebar_class_name:"green"},sidebar:"tutorialSidebar",previous:{title:"Terraform State",permalink:"/terranetes-controller/admin/state"},next:{title:"Customize Job Template",permalink:"/terranetes-controller/admin/template"}},l={},c=[];function d(e){const n={a:"a",code:"code",h1:"h1",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"kubernetes-rbac",children:"Kubernetes RBAC"})}),"\n",(0,a.jsx)(n.p,{children:"The following gives some guidance around the suggested roles and permissions in Kubernetes for consumers. In all cases, to remove duplication, the permissions are defined as a ClusterRole and bound locally within a namespace."}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Create the ClusterRoles used to scoped the ",(0,a.jsx)(n.code,{children:"terraform.appvia.io"})," resources."]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: terranetes-users\nrules:\n  - apiGroups:\n      - terraform.appvia.io\n    resources:\n      - cloudresources\n      - configurations\n      - plans\n      - providers\n      - revisions\n    verbs:\n      - get\n      - list\n      - watch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: terranetes-cr-user\nrules:\n  - apiGroups:\n      - terraform.appvia.io\n    resources:\n      - cloudresources\n    verbs:\n      - create\n      - delete\n      - update\n      - patch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: terranetes-cfg-user\nrules:\n  - apiGroups:\n      - terraform.appvia.io\n    resources:\n      - configurations\n    verbs:\n      - create\n      - delete\n      - update\n      - patch\n"})}),"\n",(0,a.jsxs)(n.ol,{start:"2",children:["\n",(0,a.jsx)(n.li,{children:"Depending whether you are using CloudResource or Configuration, bind the appropriate role within the namespace"}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: terranetes-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: terranetes-user\nsubjects:\n  - apiGroup: rbac.authorization.k8s.io\n    kind: Group\n    name: system:authenticated\n"})}),"\n",(0,a.jsxs)(n.p,{children:["If you using ",(0,a.jsx)(n.a,{href:"/terranetes-controller/reference/cloudresources.terraform.appvia.io",children:"CloudResources"})," use the following role."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: terranetes-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: terranetes-cr-users\nsubjects: [] <-- Add subjects\n"})}),"\n",(0,a.jsxs)(n.p,{children:["Else if your using ",(0,a.jsx)(n.a,{href:"/terranetes-controller/reference/configurations.terraform.appvia.io",children:"Configurations"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: terranetes-user\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: terranetes-cfg-users\nsubjects: [] <-- Add subjects\n"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var a=r(6540);const s={},t=a.createContext(s);function o(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);