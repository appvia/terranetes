"use strict";(self.webpackChunkterranetes=self.webpackChunkterranetes||[]).push([[8541],{3447:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var r=t(4848),i=t(8453);const o={sidebar_position:3},a="Configuration Contexts",s={id:"developer/contexts",title:"Configuration Contexts",description:"Configuration Contexts are a means to share common configuration (inputs) between Configurations in the cluster.",source:"@site/docs/terranetes-controller/developer/contexts.md",sourceDirName:"developer",slug:"/developer/contexts",permalink:"/terranetes-controller/developer/contexts",draft:!1,unlisted:!1,editUrl:"https://github.com/appvia/terranetes/tree/master/docs/terranetes-controller/developer/contexts.md",tags:[],version:"current",lastUpdatedBy:"Rohith Jayawardene",lastUpdatedAt:173030469e4,sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Using Private Repositories",permalink:"/terranetes-controller/developer/private"},next:{title:"Enabling Drift Protection",permalink:"/terranetes-controller/developer/drift"}},c={},l=[{value:"Viewing the Contexts",id:"viewing-the-contexts",level:2},{value:"Referencing Context Values",id:"referencing-context-values",level:2},{value:"Field Definitions",id:"field-definitions",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"configuration-contexts",children:"Configuration Contexts"})}),"\n",(0,r.jsxs)(n.p,{children:["Configuration ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Contexts"})," are a means to share common configuration (inputs) between ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/configurations.terraform.appvia.io",children:"Configurations"})," in the cluster."]}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"This feature is only available from v0.3.25 onwards"})}),"\n",(0,r.jsxs)(n.p,{children:["These are provisioned by the platform team, but can be referenced by any ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/configurations.terraform.appvia.io",children:"Configuration"})]}),"\n",(0,r.jsx)(n.h2,{id:"viewing-the-contexts",children:"Viewing the Contexts"}),"\n",(0,r.jsxs)(n.p,{children:["You can list all the ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Contexts"})," available via"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"$ kubectl get contexts\n"})}),"\n",(0,r.jsxs)(n.p,{children:["The contains is a map of entities which contains both a ",(0,r.jsx)(n.code,{children:"description"})," an d ",(0,r.jsx)(n.code,{children:"value"}),", as such;"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"---\napiVersion: terraform.appvia.io/v1alpha1\nkind: Context\nmetadata:\n  name: default\nspec:\n  #\n  ## All variables MUST follow the pattern of 'description' and 'value'. The\n  ## value can be any complex or simple type (boolean, int, map, object etc)\n  #\n  variables:\n    environment:\n      description: Is the environment your running in\n      value: dev\n    # Is the name of the variable\n    vpc_id:\n      # Provides a description to the consumer of the input\n      description: Is the network identifier we are residing\n      # The value of the value\n      value: vpc-1223133113\n    public_subnets_ids:\n      # Provides a description to the consumer of the input\n      description: |\n        Is a collection of subnet id's which are publicly available i.e.\n        they are attached to an internet gateway\n      # The value of the value\n      value:\n        - subnet-12312312312\n        - subnet-32332321312\n"})}),"\n",(0,r.jsx)(n.h2,{id:"referencing-context-values",children:"Referencing Context Values"}),"\n",(0,r.jsxs)(n.p,{children:["You can reference a ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Context"})," value using the ",(0,r.jsx)(n.code,{children:"spec.valueFrom"})," field in the ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/configurations.terraform.appvia.io",children:"Configuration"})]}),"\n",(0,r.jsx)(n.p,{children:"For instance if we have a module that requires knowledge of the VPC id, we can use"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"  ---\n  apiVersion: terraform.appvia.io/v1alpha1\n  kind: Configuration\n  metadata:\n    name: bucket\n  spec:\n    module: https://github.com/terraform-aws-modules/terraform-aws-rds\n\n    providerRef:\n      name: aws\n    valueFrom:\n      - context: NAME_OF_CONTEXT\n        key: vpc\n        name: vpc_id\n        optional: true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"field-definitions",children:"Field Definitions"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"context"})," is the name of the ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Context"})," resource to reference."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"key"})," is the name of the variable inside the ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Context"})," resource."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," is the name we present the value to the terraform module - i.e you might need ",(0,r.jsx)(n.code,{children:"vpc_id"})," mapped to ",(0,r.jsx)(n.code,{children:"network_id"})," or ",(0,r.jsx)(n.code,{children:"vpc"})," in the module."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"optional"})," controls if the value or ",(0,r.jsx)(n.a,{href:"/terranetes-controller/reference/contexts.terraform.appvia.io",children:"Context"})," needs to exist, if true, any missing value is ignored."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var r=t(6540);const i={},o=r.createContext(i);function a(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);